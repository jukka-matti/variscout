---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Hero from "../../components/Hero.astro";
import MiniJourney from "../../components/MiniJourney.astro";
import FourPillars from "../../components/FourPillars.astro";
import UseCaseCard from "../../components/UseCaseCard.astro";
import ProductCard from "../../components/ProductCard.astro";
import { ui } from "../../i18n/ui";
import { getLangFromUrl } from "../../i18n/utils";

export function getStaticPaths() {
  const languages = Object.keys(ui);
  return languages.map((lang) => ({ params: { lang } }));
}

const lang = getLangFromUrl(Astro.url);

const hero = {
	headline: "See Beyond Averages.",
	emphasis: "Find your 46%.",
	subhead: "46% of your improvement potential may be hiding in one place. VaRiScout finds WHERE to focus. Simple enough for anyone. Rigorous enough for experts.",
	primaryCTA: { text: "Try Free", href: "/app" },
	secondaryCTA: { text: "Take the Journey", href: `/${lang}/journey` },
	primaryCTANote: "Free — no signup required",
	showAveragesHook: true,
};

const useCases = [
	{
		id: "bottleneck",
		title: "Find the Real Bottleneck",
		description: "Stop guessing which station is the constraint. Let variation analysis show you where unpredictability hides.",
		bullets: ["Compare stations visually", "Variation reveals the truth", "Fix the right problem first"],
		cta: { text: "See How", href: `/${lang}/use-cases/bottleneck-analysis` },
	},
	{
		id: "supplier",
		title: "Monitor Supplier Quality",
		description: "Your supplier scorecard shows 95% pass rate. But one supplier is drifting toward failure.",
		bullets: ["Real-time Cpk tracking", "Detect drift early", "Data-backed conversations"],
		cta: { text: "See How", href: `/${lang}/use-cases/supplier-performance` },
	},
	{
		id: "education",
		title: "Teach SPC Without Barriers",
		description: "Your students should learn variation thinking, not navigate complex software menus.",
		bullets: ["Free forever for education", "16 sample datasets", "Interactive case studies"],
		cta: { text: "See How", href: `/${lang}/use-cases/university-spc` },
	},
];

const products = [
	{ id: "pwa", title: "Web App", description: "Free training & education tool. Paste data or explore samples.", price: "FREE forever", cta: { text: "Try Free", href: "/app" }, badge: "Best for Learning" },
	{ id: "excel", title: "Excel Add-in", description: "Core SPC charts inside Excel.", price: "FREE forever", cta: { text: "Get Add-in", href: `/${lang}/product/excel` } },
	{ id: "azure", title: "Azure App", description: "Full analysis for teams. All features, unlimited users.", price: "€150/month", cta: { text: "Learn More", href: `/${lang}/product/azure` }, badge: "Full Power" },
];
---

<BaseLayout>
	<Hero {...hero} />

	<!-- Mini Journey: The Transformation -->
	<MiniJourney lang={lang} />

	<!-- Products -->
	<section class="py-24 bg-white border-b border-neutral-200">
		<div class="container-wide">
			<div class="text-center mb-16">
				<h2 class="text-3xl font-bold mb-4">Choose Your Platform</h2>
				<p class="text-neutral-600">Same analysis, wherever you work</p>
			</div>
			<div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
				{products.map((product) => <ProductCard {...product} />)}
			</div>
		</div>
	</section>

	<!-- Use Cases -->
	<section class="py-24 bg-neutral-50 overflow-hidden">
		<div class="container-wide">
			<h2 class="text-3xl font-bold text-center mb-16">Built for Every Quality Role</h2>
			<div class="grid md:grid-cols-3 gap-8">
				{useCases.map((useCase) => <UseCaseCard {...useCase} />)}
			</div>
		</div>
	</section>

	<!-- Four Pillars: The Framework -->
	<FourPillars lang={lang} />

	<!-- Final CTA -->
	<section class="py-24 bg-brand-primary text-white overflow-hidden relative">
		<div class="absolute inset-0 opacity-10">
			<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] border border-white rounded-full"></div>
			<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] border border-white rounded-full"></div>
		</div>
		<div class="container-wide text-center relative z-10">
			<h2 class="text-4xl font-bold mb-6">Where's YOUR 46%?</h2>
			<p class="text-brand-primary-light text-xl mb-10 max-w-2xl mx-auto">
				Your data is hiding opportunity. Find it. Fix it. Check it. Continue.
			</p>
			<div class="flex flex-col sm:flex-row gap-4 justify-center">
				<a href="/app" class="btn bg-white text-brand-primary hover:bg-neutral-50 text-lg px-10 py-4 shadow-xl">
					Try Free - No Signup
				</a>
				<a href={`/${lang}/journey`} class="btn border-2 border-white text-white hover:bg-white/10 text-lg px-10 py-4">
					Take the Journey
				</a>
			</div>
			<p class="mt-6 text-sm text-white/60">
				Your data stays on your device. Always.
			</p>
		</div>
	</section>
</BaseLayout>
