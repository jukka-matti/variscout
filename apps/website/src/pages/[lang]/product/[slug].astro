---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { ArrowRight } from "lucide-astro";
import { ui } from "../../../i18n/ui";
import JourneyProductBadge from "../../../components/JourneyProductBadge.astro";
import JourneyFeatures from "../../../components/JourneyFeatures.astro";

interface JourneyFeaturesData {
	findIt: {
		pillars: {
			change: boolean;
			flow: boolean;
			failure: boolean;
			value: boolean;
		};
		extras?: string[];
	};
	fixIt: string[];
	checkIt: string[];
	continue: string[];
}

interface ProductProps {
	title: string;
	description: string;
	heroTitle: string;
	heroSub: string;
	journeyFeatures: JourneyFeaturesData;
	cta: { text: string; href: string };
}

export function getStaticPaths() {
	const languages = Object.keys(ui);
	const products: Array<{ slug: string; props: ProductProps }> = [
		{
			slug: "web-app",
			props: {
				title: "VaRiScout Web App",
				description: "Free training & education tool for quality professionals worldwide.",
				heroTitle: "Professional SPC analysis. Free forever.",
				heroSub: "Core SPC + Green Belt tools for training, education, and quality practitioners. Copy-paste from Excel, explore sample datasets, analyze in your browser. No signup required.",
				journeyFeatures: {
					findIt: {
						pillars: { change: true, flow: true, failure: true, value: true },
						extras: ["16 sample datasets", "Copy-paste from Excel"],
					},
					fixIt: [
						"Visual drill-down to root cause",
						"Filter and compare factors",
						"Plain language insights",
					],
					checkIt: [
						"Before/after comparison",
						"Statistical validation",
					],
					continue: [
						"Works offline after first visit",
						"No signup required",
						"Session-based (no persistence)",
					],
				},
				cta: { text: "Try Free", href: "/app" },
			}
		},
		{
			slug: "excel",
			props: {
				title: "VaRiScout for Excel",
				description: "Core SPC charts directly in your Excel spreadsheets. Free forever.",
				heroTitle: "Find variation where your data lives.",
				heroSub: "The VaRiScout Excel Add-in brings core SPC charts to your everyday spreadsheets. I-Chart, Boxplot, Pareto, and Capability — free forever from Microsoft AppSource.",
				journeyFeatures: {
					findIt: {
						pillars: { change: true, flow: true, failure: true, value: false },
						extras: ["Auto-refresh when data changes", "Range selection wizard"],
					},
					fixIt: [
						"Export findings directly to cells",
						"Filter data with native Excel slicers",
						"Highlight outliers in source range",
					],
					checkIt: [
						"Real-time updates when data changes",
						"Compare before/after in same workbook",
					],
					continue: [
						"Save chart configs in workbook",
						"Share analysis with colleagues",
					],
				},
				cta: { text: "Get from AppSource", href: "https://appsource.microsoft.com/" },
			}
		},
		{
			slug: "azure",
			props: {
				title: "VaRiScout for Azure",
				description: "Full analysis platform for teams. All features, unlimited users. €150/month.",
				heroTitle: "Your infrastructure. Your data. Full power.",
				heroSub: "Managed Application from Azure Marketplace. All features including Performance Mode, file upload, save and persistence, OneDrive sync, and SSO — deployed in your Azure tenant at €150/month.",
				journeyFeatures: {
					findIt: {
						pillars: { change: true, flow: true, failure: true, value: true },
						extras: ["Performance Mode (100+ channels)", "File upload (CSV, Excel)"],
					},
					fixIt: [
						"Create action items from findings",
						"Assign tasks to team members",
						"Track resolution status",
					],
					checkIt: [
						"Save and persistence",
						"Before/after snapshots",
						"OneDrive sync across devices",
					],
					continue: [
						"SSO via Azure AD / Entra ID",
						"Unlimited team members",
						"Data stays in your tenant",
					],
				},
				cta: { text: "Azure Marketplace", href: "https://azuremarketplace.microsoft.com/" },
			}
		},
	];

	return languages.flatMap((lang) =>
		products.map((product) => ({
			params: { lang, slug: product.slug },
			props: product.props
		}))
	);
}

const { lang } = Astro.params;
const { title, description, heroTitle, heroSub, journeyFeatures, cta } = Astro.props;
---

<BaseLayout title={`VaRiScout | ${title}`} description={description}>
	<!-- Journey badge -->
	<JourneyProductBadge lang={lang as string} />

	<!-- Hero -->
	<section class="py-20 md:py-28 bg-white">
		<div class="container-wide">
			<div class="grid md:grid-cols-2 gap-16 items-center">
				<div>
					<a href={`/${lang}`} class="text-sm font-medium text-brand-primary mb-4 block hover:underline">
						← Back to Home
					</a>
					<h1 class="text-4xl md:text-5xl font-bold mb-6 text-neutral-900">{heroTitle}</h1>
					<p class="text-xl text-neutral-600 mb-10 leading-relaxed">
						{heroSub}
					</p>
					<div class="flex flex-wrap gap-4">
						<a href={cta.href} target="_blank" rel="noopener" class="btn btn-primary px-8 py-3">{cta.text}</a>
						<a href={`/${lang}/pricing`} class="btn btn-secondary px-8 py-3">View Pricing</a>
					</div>
				</div>
				<div class="bg-neutral-100 rounded-3xl aspect-[4/3] flex items-center justify-center border border-neutral-200">
					<span class="text-neutral-400 font-medium">[Product UI Screenshot]</span>
				</div>
			</div>
		</div>
	</section>

	<!-- Journey Features -->
	<JourneyFeatures features={journeyFeatures} />

	<!-- Journey CTA -->
	<section class="py-20 bg-white">
		<div class="container-wide text-center">
			<h2 class="text-3xl font-bold mb-4 text-neutral-900">Run Your Own Journey</h2>
			<p class="text-neutral-600 mb-8 max-w-2xl mx-auto">
				Apply the same methodology that found the 46% to your own data.
				Find it. Fix it. Check it. Continue.
			</p>
			<div class="flex flex-col sm:flex-row justify-center items-center gap-4">
				<a href={cta.href} target="_blank" rel="noopener" class="btn btn-primary px-8 py-3">
					{cta.text}
				</a>
				<a href={`/${lang}/journey`} class="btn btn-outline px-8 py-3">
					See the Full Journey
				</a>
			</div>
			<div class="mt-8">
				<a href="/app" class="inline-flex items-center gap-2 text-brand-primary font-bold hover:gap-3 transition-all">
					Or try the Web App free <ArrowRight size={20} />
				</a>
			</div>
		</div>
	</section>
</BaseLayout>
