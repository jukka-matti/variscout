---
/**
 * JourneyFeatures - Features organized by journey phases
 * FIND IT (pillars) → FIX IT → CHECK IT → CONTINUE
 */

import { Check } from 'lucide-astro';

interface JourneyFeaturesData {
	findIt: {
		pillars: {
			change: boolean;
			flow: boolean;
			failure: boolean;
			value: boolean;
		};
		extras?: string[];
	};
	fixIt: string[];
	checkIt: string[];
	continue: string[];
}

interface Props {
	features: JourneyFeaturesData;
}

const { features } = Astro.props;

const pillars = [
	{ key: 'change' as const, name: 'I-Chart', pillarLabel: 'CHANGE', color: 'blue', description: 'See patterns over time' },
	{ key: 'flow' as const, name: 'Boxplot', pillarLabel: 'FLOW', color: 'orange', description: 'Compare factors' },
	{ key: 'failure' as const, name: 'Pareto', pillarLabel: 'FAILURE', color: 'red', description: 'Find concentration' },
	{ key: 'value' as const, name: 'Capability', pillarLabel: 'VALUE', color: 'green', description: 'Check against specs' },
];

const phases = [
	{
		key: 'fixIt' as const,
		label: 'FIX IT',
		color: 'amber',
		bgClass: 'bg-amber-500/10',
		textClass: 'text-amber-600',
		borderClass: 'border-amber-500/30',
		description: 'Take targeted action',
	},
	{
		key: 'checkIt' as const,
		label: 'CHECK IT',
		color: 'teal',
		bgClass: 'bg-teal-500/10',
		textClass: 'text-teal-600',
		borderClass: 'border-teal-500/30',
		description: 'Verify your improvement',
	},
	{
		key: 'continue' as const,
		label: 'CONTINUE',
		color: 'brand',
		bgClass: 'bg-brand-primary/10',
		textClass: 'text-brand-primary',
		borderClass: 'border-brand-primary/30',
		description: 'Keep finding more',
	},
];
---

<section class="py-16 bg-neutral-50 border-y border-neutral-200">
	<div class="container-wide">
		<div class="text-center mb-12">
			<h2 class="text-3xl font-bold text-neutral-900">What You Can Do</h2>
			<p class="text-neutral-600 mt-2">Features organized by the VaRiScout journey</p>
		</div>

		<!-- FIND IT: Pillar capability grid -->
		<div class="mb-12">
			<div class="flex items-center gap-3 mb-6">
				<div class="w-10 h-10 rounded-xl bg-purple-500/10 flex items-center justify-center">
					<svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
					</svg>
				</div>
				<div>
					<h3 class="text-xl font-bold text-purple-600">FIND IT</h3>
					<p class="text-neutral-500 text-sm">See what averages hide</p>
				</div>
			</div>

			<div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
				{pillars.map((p) => (
					<div
						class:list={[
							'p-5 rounded-xl border-2 transition-all',
							features.findIt.pillars[p.key]
								? `bg-${p.color}-500/10 border-${p.color}-500/30`
								: 'bg-neutral-100 border-neutral-200 opacity-50',
						]}
					>
						<div class="flex items-start justify-between mb-2">
							<span
								class:list={[
									'text-xs font-bold uppercase tracking-wider',
									features.findIt.pillars[p.key] ? `text-${p.color}-500` : 'text-neutral-400',
								]}
							>
								{p.pillarLabel}
							</span>
							{features.findIt.pillars[p.key] && (
								<div class="w-5 h-5 rounded-full bg-green-500/20 flex items-center justify-center">
									<Check class="w-3 h-3 text-green-600" />
								</div>
							)}
						</div>
						<p class="font-semibold text-neutral-900">{p.name}</p>
						<p class="text-sm text-neutral-600 mt-1">{p.description}</p>
					</div>
				))}
			</div>

			{features.findIt.extras && features.findIt.extras.length > 0 && (
				<div class="mt-4 flex flex-wrap gap-2">
					{features.findIt.extras.map((extra) => (
						<span class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-purple-500/10 text-purple-700 rounded-full text-sm">
							<Check class="w-3.5 h-3.5" />
							{extra}
						</span>
					))}
				</div>
			)}
		</div>

		<!-- FIX IT, CHECK IT, CONTINUE -->
		<div class="grid md:grid-cols-3 gap-6">
			{phases.map((phase) => (
				<div class={`p-6 rounded-xl border-2 ${phase.bgClass} ${phase.borderClass}`}>
					<div class="flex items-center gap-2 mb-4">
						<h3 class={`text-lg font-bold ${phase.textClass}`}>{phase.label}</h3>
					</div>
					<p class="text-neutral-500 text-sm mb-4">{phase.description}</p>
					<ul class="space-y-3">
						{features[phase.key].map((feature) => (
							<li class="flex items-start gap-2">
								<Check class={`w-4 h-4 mt-0.5 ${phase.textClass}`} />
								<span class="text-neutral-700 text-sm">{feature}</span>
							</li>
						))}
					</ul>
				</div>
			))}
		</div>
	</div>
</section>
