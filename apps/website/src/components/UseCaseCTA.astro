---
import { getToolBySlug } from "../data/toolsData";

interface Props {
	relatedCases: string[];
	relatedTools: string[];
	platformFit: Array<{
		stage: string;
		product: 'pwa' | 'excel' | 'azure';
		reason: string;
	}>;
	lang: string;
}

const { relatedTools, platformFit, lang } = Astro.props;

const productLabels: Record<string, string> = {
	pwa: 'Web App (Free)',
	excel: 'Excel Add-in (Free)',
	azure: 'Azure App',
};

const productLinks: Record<string, string> = {
	pwa: '/app',
	excel: `/${lang}/product/excel`,
	azure: `/${lang}/product/azure`,
};
---

<section class="py-16 bg-neutral-50">
	<div class="container-wide">
		<div class="max-w-3xl">
			{/* Platform Fit */}
			<h2 class="text-sm font-bold text-neutral-400 uppercase tracking-wider mb-6">Which VaRiScout Is Right?</h2>
			<div class="space-y-4 mb-12">
				{platformFit.map((fit) => (
					<a
						href={productLinks[fit.product]}
						class="flex items-start gap-4 p-4 bg-white border border-neutral-200 rounded-lg hover:border-brand-primary/30 hover:shadow-sm transition-all group"
					>
						<div class="shrink-0 mt-0.5">
							<span class="text-xs font-bold text-neutral-500 uppercase tracking-wider">{fit.stage}</span>
						</div>
						<div class="flex-1">
							<div class="font-semibold text-neutral-900 group-hover:text-brand-primary transition-colors">
								{productLabels[fit.product]}
							</div>
							<p class="text-sm text-neutral-600">{fit.reason}</p>
						</div>
					</a>
				))}
			</div>

			{/* Related Tools */}
			{relatedTools.length > 0 && (
				<div class="mb-12">
					<h2 class="text-sm font-bold text-neutral-400 uppercase tracking-wider mb-4">Tools Used</h2>
					<div class="flex flex-wrap gap-3">
						{relatedTools.map((toolSlug) => {
							const tool = getToolBySlug(toolSlug);
							if (!tool) return null;
							return (
								<a
									href={`/${lang}/tools/${toolSlug}`}
									class="flex items-center gap-2 px-4 py-2 bg-white border border-neutral-200 rounded-full text-sm font-medium text-neutral-700 hover:border-neutral-300 hover:shadow-sm transition-all"
								>
									<span class={`w-2 h-2 rounded-full ${tool.colorClass.replace('text-', 'bg-')}`}></span>
									{tool.name}
								</a>
							);
						})}
					</div>
				</div>
			)}
		</div>
	</div>
</section>

{/* Final CTA */}
<section class="py-20 bg-neutral-900 text-white">
	<div class="container-wide">
		<div class="max-w-2xl mx-auto text-center">
			<h2 class="text-3xl md:text-4xl font-bold mb-4">Ready to try with your data?</h2>
			<p class="text-lg text-neutral-300 mb-8">
				Paste your data, see the pattern. Free, no signup, your data stays on your device.
			</p>
			<div class="flex flex-col sm:flex-row gap-4 justify-center">
				<a href="/app" class="btn btn-primary px-8 py-3">
					Try Free - No Signup
				</a>
				<a href={`/${lang}/cases`} class="btn btn-outline-light px-8 py-3">
					Practice with Cases
				</a>
			</div>
			<p class="mt-6 text-sm text-neutral-500">
				Your data stays on your device. Always.
			</p>
		</div>
	</div>
</section>
